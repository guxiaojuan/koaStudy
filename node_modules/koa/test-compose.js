const compose = require('koa-compose');

const getData = () => {
	new Promise((resolve, reject) => {
		console.log('------fun1--promise')
		setTimeout(() => {
			resolve(console.log('--fun1-------data---------'))
		}, 2000)
	})
}


async function fun1(context, next) {
	console.log("middleware1-----------------");
	await getData();
	next();
	console.log("-------next1---------")
}


function fun2(context, next) {
	console.log("middleware2----------------");
	setTimeout(() => {
		console.log(`inner2:${context}`);
		next();
		console.log("--------------next2------")
	}, 1000)
}

function fun3(context, next) {
	console.log("middleware3------------");
}



const run = compose([fun1, fun2, fun3]);

run('test', function() {
	console.log("all done");
})
